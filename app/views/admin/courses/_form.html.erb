<%= form_with(model: [:admin, course], local: true, html: { class: "needs-validation" }) do |f| %>
  <%= render "shared/error_messages", object: f.object %>

  <div class="mb-4">
    <%= f.label :title, t(".course_name"), class: "form-label fw-bold" %>
    <%= f.text_field :title, class: "form-control", placeholder: t(".enter_course_name") %>
  </div>

  <div class="mb-4">
    <%= f.label :description, t(".course_description"), class: "form-label fw-bold" %>
    <%= f.text_area :description, class: "form-control", placeholder: t(".enter_course_description"), rows: 3 %>
  </div>

  <div class="row">
    <!-- Lessons Column -->
    <div class="col-md-6">
      <div class="mb-4">
        <label class="form-label fw-bold"><%= t(".lesson") %></label>
        <div class="selected-lessons d-flex flex-wrap gap-2 mb-2">
          <% course.lessons.each do |lesson| %>
            <div class="badge bg-primary text-light d-flex align-items-center px-2 py-1 me-2">
              <%= lesson.title %>
              <span class="ms-2 text-white pointer remove-lesson" data-lesson-id="<%= lesson.id %>">&times;</span>
              <input type="hidden" name="course[lessons_attributes][][id]" value="<%= lesson.id %>">
              <input type="hidden" name="course[lessons_attributes][][title]" value="<%= lesson.title %>">
              <input type="hidden" name="course[lessons_attributes][][_destroy]" value="false">
            </div>
          <% end %>
        </div>
        <button class="btn btn-outline-primary" id="add-lesson-btn" type="button">
          <%= t(".add_lesson") %>
        </button>
      </div>
    </div>

    <!-- Admins Column (Semantic UI Dropdown) -->
    <div class="col-md-6">
      <div class="mb-4">
        <label class="form-label fw-bold"><%= t(".admin") %></label>
        <div class="ui fluid multiple search selection dropdown" id="admin-dropdown">
          <input type="hidden" name="course[course_admin_ids][]" multiple value="<%= @course.admins.pluck(:id).join(',') %>">
          <i class="dropdown icon"></i>
          <div class="default text"><%= t(".select_admin") %></div>
          <div class="menu">
            <% @admin_users.each do |admin| %>
              <div class="item" data-value="<%= admin.id %>"><%= admin.name %></div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Duration -->
  <div class="mb-4">
    <%= f.label :duration, t(".course_duration"), class: "form-label fw-bold" %>
    <%= f.number_field :duration,
                      class: "form-control",
                      placeholder: t(".enter_duration_days"),
                      min: Settings.course.min_duration,
                      max: Settings.course.max_duration,
                      step: 1 %>
  </div>


  <div class="form-group text-end">
    <%= f.submit yield(:button_text), class: "btn btn-primary px-4" %>
  </div>
<% end %>
